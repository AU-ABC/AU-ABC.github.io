<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Samuele Soraggi, Manuel Peral Vazquez">
<meta name="dcterms.date" content="2024-09-03">
<meta name="description" content="Slides and bash intro at the ABC.4">

<title>ABC.4: Introduction to bash language for bioinformatics – ABC - Accessible Bioinformatics Cafe</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-79bb3942e891885f9f7af119cd221462.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-37bb72f48501692975d9c066fdeb097b.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-3b8a0a82fbe9f278d192ed62e49db174.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WG01Z2LJ1J"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WG01Z2LJ1J', { 'anonymize_ip': true});
</script>


<meta property="og:title" content="ABC.4: Introduction to bash language for bioinformatics – ABC - Accessible Bioinformatics Cafe">
<meta property="og:description" content="Slides and bash intro at the ABC.4">
<meta property="og:image" content="https://abc.au.dk
litesrv._domainkey.birc.au.dk/documentation/2024-09-03-ABC4/bash.png">
<meta property="og:site_name" content="ABC - Accessible Bioinformatics Cafe">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="482">
<meta property="og:image:width" content="680">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/ABClogo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ABC - Accessible Bioinformatics Cafe</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../news.html"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tips" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tips</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tips">    
        <li>
    <a class="dropdown-item" href="../tips/bash.html">
 <span class="dropdown-text">Bash</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tips/R.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tips/python.html">
 <span class="dropdown-text">Python</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../Documentation.html"> 
<span class="menu-text">Documentation</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/AU-ABC"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#some-terminology" id="toc-some-terminology" class="nav-link" data-scroll-target="#some-terminology">Some terminology</a></li>
  <li><a href="#efficiency-and-speed" id="toc-efficiency-and-speed" class="nav-link" data-scroll-target="#efficiency-and-speed">Efficiency and Speed</a></li>
  </ul></li>
  <li><a href="#slides" id="toc-slides" class="nav-link" data-scroll-target="#slides">Slides</a></li>
  <li><a href="#tutorial" id="toc-tutorial" class="nav-link" data-scroll-target="#tutorial">Tutorial</a>
  <ul class="collapse">
  <li><a href="#terminal-and-folders-anatomy" id="toc-terminal-and-folders-anatomy" class="nav-link" data-scroll-target="#terminal-and-folders-anatomy">Terminal and folders anatomy</a>
  <ul class="collapse">
  <li><a href="#home-directory" id="toc-home-directory" class="nav-link" data-scroll-target="#home-directory">Home directory ~</a></li>
  <li><a href="#current-working-directory-cwd" id="toc-current-working-directory-cwd" class="nav-link" data-scroll-target="#current-working-directory-cwd">Current working directory (cwd)</a></li>
  <li><a href="#paths-and-navigating-the-directory-tree" id="toc-paths-and-navigating-the-directory-tree" class="nav-link" data-scroll-target="#paths-and-navigating-the-directory-tree">Paths and navigating the directory tree</a></li>
  <li><a href="#navigating-folders" id="toc-navigating-folders" class="nav-link" data-scroll-target="#navigating-folders">Navigating folders</a></li>
  </ul></li>
  <li><a href="#working-with-text-files" id="toc-working-with-text-files" class="nav-link" data-scroll-target="#working-with-text-files">Working with (text) files</a>
  <ul class="collapse">
  <li><a href="#less-for-reading-files" id="toc-less-for-reading-files" class="nav-link" data-scroll-target="#less-for-reading-files">Less for reading files</a></li>
  <li><a href="#file-properties" id="toc-file-properties" class="nav-link" data-scroll-target="#file-properties">File properties</a></li>
  <li><a href="#copy-and-move" id="toc-copy-and-move" class="nav-link" data-scroll-target="#copy-and-move">Copy and Move</a></li>
  <li><a href="#writing-on-a-file" id="toc-writing-on-a-file" class="nav-link" data-scroll-target="#writing-on-a-file">Writing on a file</a></li>
  <li><a href="#piping" id="toc-piping" class="nav-link" data-scroll-target="#piping">Piping</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ABC.4: Introduction to bash language for bioinformatics</h1>
  <div class="quarto-categories">
    <div class="quarto-category">bash</div>
    <div class="quarto-category">command line</div>
  </div>
  </div>

<div>
  <div class="description">
    Slides and bash intro at the ABC.4
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Samuele Soraggi, Manuel Peral Vazquez </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 3, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>tutorial under construction</p>
</div>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The difficulty of learning bash is often underestimated by others, who expect people approaching bioinformatics to learn it automatically. Here we try to put together the first basic concepts and commands.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Why the bash command line?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why the bash command line?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the bash command line becomes quickly essential if you are doing bioinformatics.</p>
<p>First of all, you might need it to <strong>access a computing cluster</strong> (for example, GenomeDK at Aarhus University), since most clusters runs on a <a href="https://www.hpc.iastate.edu/guides/unix-introduction">UNIX-based operating system</a>, such as Linux, using a bash command line.</p>
<p>Just as important is the fact that on a command line you can very easily <strong>do operations on multiple and very large files</strong>, something you would not be able to do using, for example, <code>R</code> or <code>python</code>. Large sequences of operations can be automatized into <strong>pipelines</strong> (an advanced topic not for this tutorial).</p>
<p>With a command line you can <strong>run many small programs, compose them together, and organize them in a chain of commands</strong>. This type of program organization fits well with what a bioinformatics project consist of: many tools to be applied repetitevely on multiple large files, and organizing those programs in a specific sequence. An example could be aligning to a reference genome many raw bulk-RNA sequencing files: the alignment operation must be repeated many times, and when files are finished, they might need to be merged if they are from the same sample.</p>
</div>
</div>
<section id="some-terminology" class="level2">
<h2 class="anchored" data-anchor-id="some-terminology">Some terminology</h2>
<p>When using a UNIX operating system (Linux, MacOs), everything on your computer fits one of two categories: <strong>processes and files</strong>. Processes are running instances of a program, and a program is any executable file stored in your computer. A file is any collection of data (program, image, video, audio, …).</p>
<p>Whenever we write a command on the terminal and press enter, we have a shell taking the code we wrote and sending it to the kernel. The <strong>shell is the outer layer of the operating system</strong>, which facilitates the communication to the kernel. The <strong>kernel is the core of the operating system</strong>, managing the computer physical components (hardware) and interfacing them with the processes that need to run. In general, any program (browser, game, …) you open or action (moving files, renaming folders, …) you do on your computer ends up being a process managed by the kernel. This communication process is shown in <a href="#fig-shellkernel" class="quarto-xref">Figure&nbsp;1</a></p>
<div id="fig-shellkernel" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-shellkernel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./2024-09-03-ABC4/shellkernel.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-shellkernel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Communication scheme where the outer layer is a bash shell command, which the shell then communicate to the kernel, which in turn manages the hardware resources to make the program actually run. Note that there can be <strong>many languages for the UNIX shell</strong>: bash is the most popular, but others exist and are used (for example <em>zsh</em> on MacOs). <em>Figure credit: InnoKrea.</em>
</figcaption>
</figure>
</div>
</section>
<section id="efficiency-and-speed" class="level2">
<h2 class="anchored" data-anchor-id="efficiency-and-speed">Efficiency and Speed</h2>
<p>We can roughly identify various levels of efficiency, manual work, speed, number and size of handled files when working with a command line, the typical languages like R and python, or bash pipelines:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 16%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>Programming mode</th>
<th>Nr of files</th>
<th>File Size</th>
<th>operational speed</th>
<th>Manual work</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>R, python, …</td>
<td>from 1 to 10s</td>
<td>small</td>
<td>slow</td>
<td>A lot</td>
</tr>
<tr class="even">
<td>Command line</td>
<td>from 1 to 100s</td>
<td>1-10s GB</td>
<td>fast</td>
<td>Low-moderate</td>
</tr>
<tr class="odd">
<td>Unix Pipeline</td>
<td>from 1 to many 1000s</td>
<td>many TB</td>
<td>fast</td>
<td>Low</td>
</tr>
</tbody>
</table>
<p>You will see in this tutorial how we can use basic bash utilities and handle text files. Those files would take longer time to read in R and python and the code to modify them would be in general longer and slower.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Why is the Bash shell fast">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why is the Bash shell fast
</div>
</div>
<div class="callout-body-container callout-body">
<p>One of the advantages of the bash shell language is that shell languages are already interpreted. This means that they travel directly from the shell to the kernel in <a href="#fig-shellkernel" class="quarto-xref">Figure&nbsp;1</a>. Languages such as <code>R</code> and <code>python</code> need to be interpreted: every time you run a command, an interpreter translates this such that the kernel is able to understand the instructions to execute. This means that the python shell sends the command to an intermediate layer (the interpreter) which finally sends the program to run to the kernel. Interpreting <code>R</code>and <code>python</code> can be inefficient, because a single command has many implicit assumptions (how to use the computer memory, how to structure the data, …) which need to be interpreted for the kernel. Other languages such as <code>C</code> are more complex to write, because the memory and the data are specified very thoroughly by the user, and the interpreter has less burden.</p>
</div>
</div>
</section>
</section>
<section id="slides" class="level1">
<h1>Slides</h1>
<p>Our slides introducing the bash shell</p>
<p>&nbsp;</p>
<p align="center">
<a href="https://abc.au.dk/documentation/slides/20240903-ABC.4.zip" style="background-color: #4266A1; color: #FFFFFF; padding: 30px 20px; text-decoration: none; border-radius: 5px;"> Download Slides </a>
</p>
<p>&nbsp;</p>
</section>
<section id="tutorial" class="level1">
<h1>Tutorial</h1>
<p>Here starts the tutorial. There is only one technical prerequisite, that is, you need a <strong>Terminal</strong>. The terminal is where you can write your commands - which are then sent to the computer to be executed.</p>
<ul>
<li><p>Mac and Linux computers already have a software called <code>Terminal</code> installed (they are both computers with UNIX-based operating systems)</p></li>
<li><p>Windows have a different sort of terminal called Powershell (it is DOS-based and not UNIX-based). Please install <code>MobaXTerm</code>, then open it and click <strong>Start Local Terminal</strong>.</p></li>
</ul>
<section id="terminal-and-folders-anatomy" class="level2">
<h2 class="anchored" data-anchor-id="terminal-and-folders-anatomy">Terminal and folders anatomy</h2>
<p>When you work in the terminal, you will always see a prompt which starts with something of this type</p>
<p><img src="./2024-09-03-ABC4/shell.png" class="img-fluid"></p>
<p>which provides you</p>
<ul>
<li>username (e.g.&nbsp;samuele)</li>
<li>computer name (e.g.&nbsp;D55749)</li>
<li>current working directory where the user is working at the moment (e.g.&nbsp;<code>~</code>, which is the short form for the home directory)</li>
</ul>
<p>In MobaXTerm you see only date, time and current working directory</p>
<section id="home-directory" class="level3">
<h3 class="anchored" data-anchor-id="home-directory">Home directory ~</h3>
<p>The home directory, which can be written as <code>~</code>, is usually of the form <code>/home/username</code>, and is private to the user (no other users of that computer can access it).</p>
<p>When you open the terminal, you always start with current working directory as your home. Try to write and execute (pressing enter) the command</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="bu">pwd</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and you will see the full home path (which is the folder structure leading to your home directory)</p>
</section>
<section id="current-working-directory-cwd" class="level3">
<h3 class="anchored" data-anchor-id="current-working-directory-cwd">Current working directory (cwd)</h3>
<p>Every command you execute refers to your cwd. For example, write</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and you will see the list of files in your cwd. Try to create an empty file now with</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">touch</span> emptyFile.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and create a folder, which will be inside our cwd:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> myFolder</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you use again the <code>ls</code> command, the new file and folder will show in the cwd.</p>
<p>Now we want to download something from the internet, for which we have a download link. We are getting a raw sequenced dataset in <code>fastq</code> format, which is currently <code>gzip</code>-compressed. The <code>wget</code> command can be used for the download. Note that now we also add an option <code>-O</code> to provide the output file name as <code>./myFolder/data.fastq.gz</code>, where the dot <code>.</code> stands for the cwd, followed by <code>myFolder</code>, followed by the file name.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/hartwigmedical/testdata/raw/master/100k_reads_hiseq/TESTX/TESTX_H7YRLADXX_S1_L001_R1_001.fastq.gz <span class="at">-O</span> ./myFolder/data.fastq.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Not all utilities are installed in MobaXTerm. If you get an error, install <code>wget</code> with the command</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">apt-get</span> <span class="at">-y</span> install wget</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="paths-and-navigating-the-directory-tree" class="level3">
<h3 class="anchored" data-anchor-id="paths-and-navigating-the-directory-tree">Paths and navigating the directory tree</h3>
<p>We have already been using directories and paths a lot, so it is time to polish some definitions. Files are organized in a directory tree, which restricted to the tutorial we are running looks like <a href="#fig-dirtree" class="quarto-xref">Figure&nbsp;2</a>. Here <code>home</code> is a root folder, which is one of the top-level folder of your computer, so it has <code>/</code> at the beginning of its name. <code>/home</code> contains a folder with your username, which is right now your cwd. Inside your cwd you have the empty file and a folder containing the data. All those folders and file are organized with a tree hierarchy, so that <code>/home</code> is the first level, <code>username the second</code>, and <code>myFolder</code> the third level. The path in the directory tree to <code>data.fastq.gz</code> is expressed as <code>/home/username/myFolder/data.fastq.gz</code>.</p>
<div id="fig-dirtree" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dirtree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./2024-09-03-ABC4/treeStructure.png" class="img-fluid figure-img" width="400">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dirtree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Directory tree of the tutorial. The home folder is a root folder (top-level of the tree) so its name starts with the <code>/</code> symbol. Other folders and files are at subsequent branch levels of the root folder <code>/home</code>. Some folders specific to your computer might be missing from this scheme.
</figcaption>
</figure>
</div>
<section id="absolute-and-relative-path" class="level4">
<h4 class="anchored" data-anchor-id="absolute-and-relative-path">Absolute and relative path</h4>
<p>The path <code>/home/username/myFolder/data.fastq.gz</code> is called <strong>absolute</strong> because independent of your cwd. Let’s try another absolute path: the root folder <code>/usr</code> contains all executable files of the bash utilities we are using in this tutorial. Such files are in the folder <code>bin</code>. Execute</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> /usr/bin/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The output is a long list of executable files and some folders (sometimes they also have different colors, depending on your terminal settings). If you scroll and look, you can find familiar names like <code>wget, ls</code>, and so on. Now, this path is independent of our cwd.</p>
<p>On the contrary, the path <code>./myFolder/data.tar.gz</code> depends on the cwd, and is equivalent to write <code>myFolder/data.tar.gz</code>, because <code>./</code> is always included by default. <strong>All paths that do not start with a root folder are relative!</strong>. So to look inside <code>myFolder</code>, we can both write</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> myFolder/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> ~/myFolder/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where we have used <code>~</code> which is the shortform for /home/username.</p>
</section>
</section>
<section id="navigating-folders" class="level3">
<h3 class="anchored" data-anchor-id="navigating-folders">Navigating folders</h3>
<p>How to change your cwd? Simply use the command <em>change directory</em>. For example, you might want to work inside <code>myFolder</code>. Simply write</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> myFolder</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and verify with <code>pwd</code> the new working directory path. If we want to unzip the compressed data file, we simply use its relative path:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gunzip</span> data.fastq.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Use <code>ls</code> to verify that you have a file with name <code>data.fastq</code>.</p>
</section>
</section>
<section id="working-with-text-files" class="level2">
<h2 class="anchored" data-anchor-id="working-with-text-files">Working with (text) files</h2>
<p>Many files you use in bioinformatics are nothing else than text files which are written in a specific matter. This specific way of arranging the text in the files gives you all the <strong>file formats</strong> you encounter when doing bioinformatics.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some file formats are encoded differently than with plain text, and cannot usually be seen with a text editor.</p>
</div>
</div>
<section id="less-for-reading-files" class="level3">
<h3 class="anchored" data-anchor-id="less-for-reading-files">Less for reading files</h3>
<p>The first thing you want to do, is to check at how the content of a file looks like. The program <code>less</code> is perfect for this purpose: you can scroll text with the arrows, and use the keyboard to do operations like searching for text or jumping to a line. Try</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">less</span> data.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and see the format of your data, where each four lines provide a sequence. The very first sequence you see should be</p>
<pre><code>@HISEQ_HU01:89:H7YRLADXX:1:1101:1116:2123 1:N:0:ATCACG
TCTGTGTAAATTACCCAGCCTCACGTATTCCTTTAGAGCAATGCAAAACAGACTAGACAAAAGGCTTTTAAAAGTCTA
ATCTGAGATTCCTGACCAAATGT
+
CCCFFFFFHHHHHJJJJJJJJJJJJHIJJJJJJJJJIJJJJJJJJJJJJJJJJJJJHIJGHJIJJIJJJJJHHHHHHH
FFFFFFFEDDEEEEDDDDDDDDD</code></pre>
<p>Here the first line is informative of the sequence, the second is the sequence itself and then you have an empty line (symbol +), followed by the quality scores (encoded by letters following <a href="https://learn.gencore.bio.nyu.edu/ngs-file-formats/quality-scores/">this table</a>).</p>
<p>Try to scroll in all directions to explore some lines in the file. If you want to exit from the text viewer, press <code>q</code>.</p>
<div class="callout-tips" title="Exercise" data-icon="false">
<p>Try to search online how to search a specific work in a file with <code>less</code>. Then visualize the data and try to find if there is any sequence containing a sequence of ten <code>N</code>s (which is, ten missing nucleotides). Then, answer the question below</p>
<p><strong>How long is the shortest sequence of missing nucleotides not found anywhere in the file data.fastq?</strong><br><br></p>

<form id="quizForm">
<label> <input type="radio" name="q1" value="30"> 30 </label> <br> <label> <input type="radio" name="q1" value="25"> 25 </label> <br> <label> <input type="radio" name="q1" value="19"> 19 </label> <br> <button type="button" onclick="submitQuiz1()">Submit</button>
</form>
<script>
  function submitQuiz1() {
      var selectedOption = getSelectedOption1("q1");
      var correctAnswer = "19";

      // Display feedback
      if (selectedOption === correctAnswer) {
        alert("Correct! Good job with the bash shell!");
      } else if (selectedOption === "25") {
        alert("Nope! A bit less,");
      } else {
        alert("Nope! Much less!");
      }
    }

    function getSelectedOption1(questionName) {
      var radioButtons = document.getElementsByName(questionName);
      for (var i = 0; i < radioButtons.length; i++) {
        if (radioButtons[i].checked) {
          return radioButtons[i].value;
        }
      }
      return null;
    }
 </script>

</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Usually, a bash shell command can be found by searching for the command + man, for example <code>less man</code>. <a href="https://man7.org/linux/man-pages/man1/less.1.html">The manual of less</a> lists all the many (many many) functionalities that can be useful to explore text files, which is always a good activity to do for double checking if things are in order.</p>
<p>In general: <strong>always check the manuals</strong> or write on the prompt the option <code>--help</code> (such as <code>less --help</code>). Usually you will understand a lot of what you can do and how from that.</p>
</div>
</div>
</section>
<section id="file-properties" class="level3">
<h3 class="anchored" data-anchor-id="file-properties">File properties</h3>
<p>How big is a file? How many lines does it have? When has it been created? You can use the good old <code>ls</code> with some extra options to list all files with some extra info:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-lah</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You should get something like this depending on your computer:</p>
<pre><code>totalt 6,3M
drwxr-xr-x+ 1 au612681 UsersGrp    0 28 aug 11:38 .
drwx------+ 1 au612681 UsersGrp    0 28 aug 10:38 ..
-rw-r--r--+ 1 au612681 UsersGrp 6,3M 28 aug 11:38 data.fastq</code></pre>
<p>the last one is clearly the data file, with creation date and size. Other infos about the file are group and user ownership and which rights we have on the files (we will not talk about these in this tutorial).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Look also at the other two elements: <code>.</code> and <code>..</code>, which represents the current directory and the one above in the directory structure. Those link you to the directories, so one can always change to the directory above by using <code>cd ..</code></p>
<p><strong>You can combine multiple times <code>..</code> to change directories multiple levels above. Where does <code>cd ../../</code> bring you to? Hint: use the terminal to try it out if you cannot remember your folder structure.</strong></p>

<form id="quizForm">
<label> <input type="radio" name="q2" value="a"> /home </label> <br> <label> <input type="radio" name="q2" value="b"> /home/myFolder </label> <br> <label> <input type="radio" name="q2" value="c"> /usr/bin </label> <br> <label> <input type="radio" name="q2" value="d"> /home/username/ </label> <br> <button type="button" onclick="submitQuiz2()">Submit</button>
</form>
<script>
  function submitQuiz2() {
      var selectedOption = getSelectedOption2("q2");
      var correctAnswer = "a";

      // Display feedback
      if (selectedOption === correctAnswer) {
        alert("Yay! You are really going ways with the shell!");
      } else{
        alert("Ups, no! How did you get into this folder!?!?!?!?");
      }
    }

    function getSelectedOption2(questionName) {
      var radioButtons = document.getElementsByName(questionName);
      for (var i = 0; i < radioButtons.length; i++) {
        if (radioButtons[i].checked) {
          return radioButtons[i].value;
        }
      }
      return null;
    }
 </script>

</div>
</div>
<p>Now, how many lines are there in your file? The command <code>wc</code> can show that to you. It has many options, but we are going to use the one to count lines in a file. As always, look for the manual or examples to see how you can use it in other many ways.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> data.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>will tell you that the file has 100000 lines, so you have 25000 sequences (each sequence is defined by 4 lines).</p>
</section>
<section id="copy-and-move" class="level3">
<h3 class="anchored" data-anchor-id="copy-and-move">Copy and Move</h3>
<p>Now we learn a few useful commands because we want to work on more than one file. We will create multiple copies of our file. To make a copy of the data file and called the new one dataCopy.fastq, do</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> data.fastq dataCopy.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then we will move <code>data.fastq</code>. You could move it in any folder, even in the current directory. If you move it into the current directory, you can use the <code>mv</code> command to simply change its name:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> data.fastq dataOriginal.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you now use <code>ls -lah</code>, you will see that you have two files of identical size and different creation dates. But… are those files identical? <code>diff</code> can tell you if you provide two file names. It will print out differences (or nothing if files are identical)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> dataOriginal.fastq dataCopy.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="writing-on-a-file" class="level3">
<h3 class="anchored" data-anchor-id="writing-on-a-file">Writing on a file</h3>
<p>You can write something on a file using <code>&gt;</code>. This writes any output from a command which would appear on the screen into a file. For example the following commands prints out the first four lines of the data, but they will end up inside the file fourLines.fastq</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-4</span> dataoriginal.fastq <span class="op">&gt;</span> fourLines.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Try to use</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> fourLines.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to see those four lines printed out directly on the screen from the file.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using again <code>&gt;</code> to write on the same file will not add text to the file, but will overwrite it with the new text.</p>
</div>
</div>
<p>Let’s append the first four lines of the data to its copy without overwriting it. This can be done using <code>&gt;&gt;</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-4</span> dataOriginal.fastq <span class="op">&gt;&gt;</span> dataCopy.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We want to run again the <code>diff</code> command to compare the two sequence files. <strong>Do you need to rewrite it? Of course not!</strong> Your bash saves the command history.</p>
<p>Keep <code>CTRL</code> (or <code>CMD</code> on Mac) pressed, and in the meanwhile press <code>r</code>, then start writing <code>diff</code>. The old command will show up and you can run it pressing <code>Enter</code>. Alternatively, press the arrow <code>UP</code> to see the history of commands backward.</p>
<p>If you run the diff command on the two files you will see an output. This shows quite a lot of information and not only the sequence which is different:</p>
<pre><code>--- dataOriginal.fastq
+++ dataCopy.fastq
@@ -99998,3 +99998,7 @@
</code></pre>
<p>means that there are additional lines in the second file (+++), missing in <code>dataOriginal.fastq</code> (- - -), and their coordinates.</p>
</section>
<section id="piping" class="level3">
<h3 class="anchored" data-anchor-id="piping">Piping</h3>
<p>A last important concept is the pipe. You can create small pipelines directly on the shell with the symbol <code>|</code>. Every time you use the pipe symbol, you get the output of a command and send it to the next command. For example, the <code>grep</code> command can find a pattern in a file in this way</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> NNNNN dataOriginal.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, what if we want to find that pattern in the first hundred sequences? Easy! We use <code>head</code>, and then pipe it into grep! When doing this, you do not need to provide a file to <code>grep</code>, and in that way it will read the output of the pipe.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-400</span> dataOriginal.fastq <span class="kw">|</span> <span class="fu">grep</span> NNNNN</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>That was cool! In this case we have a small output on screen, but the output can be really huge as well. Maybe it makes sense to count how many sequences <code>grep</code> can find. Well, can’t really do it by hand! Pipe the result once more using <code>wc</code> as we did earlier!</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-400</span> dataOriginal.fastq <span class="kw">|</span> <span class="fu">grep</span> NNNNN <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Wait a second! That sequence absolutely needs to be saved into a file. How do you do it!</p>

<form id="quizForm">
<label> <input type="radio" name="q3" value="a"> head -400 dataOriginal.fastq | grep NNNNN | sequence.fastq </label> <br> <label> <input type="radio" name="q3" value="b"> head -400 dataOriginal.fastq | grep NNNNN &lt; sequence.fastq </label> <br> <label> <input type="radio" name="q3" value="c"> sequence.fastq &lt; head -400 dataOriginal.fastq | grep NNNNN<br>
</label> <br> <label> <input type="radio" name="q3" value="d"> head -400 dataOriginal.fastq | grep NNNNN &gt; sequence.fastq </label> <br> <button type="button" onclick="submitQuiz3()">Submit</button>
</form>
<script>
  function submitQuiz3() {
      var selectedOption = getSelectedOption3("q3");
      var correctAnswer = "d";

      // Display feedback
      if (selectedOption === correctAnswer) {
        alert("Great! You are going places!");
      } else{
        alert("Sorry, try again, you are not writing into a file.");
      }
    }

    function getSelectedOption3(questionName) {
      var radioButtons = document.getElementsByName(questionName);
      for (var i = 0; i < radioButtons.length; i++) {
        if (radioButtons[i].checked) {
          return radioButtons[i].value;
        }
      }
      return null;
    }
 </script>



</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/abc\.au\.dk
litesrv\._domainkey\.birc\.au\.dk");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>